# çƒ­é—¨è¯¾ç¨‹æ’è¡ŒåŠŸèƒ½ - å®ç°æ€è·¯è¯¦è§£

## ğŸ“Œ é¡¹ç›®èƒŒæ™¯

éœ€æ±‚ï¼šæ ¹æ®è®¿é—®é‡ï¼Œåˆ—å‡ºå‰10ä¸ªçƒ­é—¨è¯¾ç¨‹ï¼Œåˆ©ç”¨Rediså¤„ç†é«˜å¹¶å‘åœºæ™¯ï¼Œç”¨MySQLè¿›è¡ŒæŒä¹…åŒ–ã€‚

---

## ğŸ¯ æ ¸å¿ƒè®¾è®¡æ€è·¯

### 1. é—®é¢˜åˆ†æ

#### æŒ‘æˆ˜
- **é«˜å¹¶å‘**ï¼šå¤§é‡ç”¨æˆ·åŒæ—¶è®¿é—®è¯¾ç¨‹ï¼Œè®¿é—®é‡ç»Ÿè®¡é¢‘ç¹
- **å®æ—¶æ€§**ï¼šéœ€è¦å¿«é€Ÿè·å–çƒ­é—¨æ’è¡Œ
- **ä¸€è‡´æ€§**ï¼šè®¿é—®æ•°æ®éœ€è¦æŒä¹…åŒ–ä¸èƒ½ä¸¢å¤±
- **æ€§èƒ½**ï¼šä¸èƒ½å› ä¸ºç»Ÿè®¡è®¿é—®è€Œå½±å“ä¸»ä¸šåŠ¡

#### è§£å†³æ–¹å‘
| éœ€æ±‚ | è§£å†³æ–¹æ¡ˆ |
|------|--------|
| é«˜å¹¶å‘å†™å…¥ | ä½¿ç”¨Redisï¼Œé¿å…æ•°æ®åº“é¢‘ç¹æ›´æ–° |
| å¿«é€Ÿæ’åº | Redis Sorted Setå¤©ç„¶æ”¯æŒæ’åº |
| æ•°æ®æŒä¹…åŒ– | å®šæ—¶åŒæ­¥åˆ°MySQL |
| æ€§èƒ½æœ€ä¼˜ | åˆ†ç¦»è¯»å†™ï¼Œç¼“å­˜+æ•°æ®åº“åŒå±‚è®¾è®¡ |

---

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### 2. ä¸ºä»€ä¹ˆé€‰æ‹©Redis Sorted Set

#### å…¶ä»–é€‰é¡¹å¯¹æ¯”

| æ–¹æ¡ˆ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‰æ‹© |
|------|------|------|------|
| **ç›´æ¥æ›´æ–°MySQL** | æ•°æ®ä¸€è‡´ | é«˜å¹¶å‘æ—¶é”ç«äº‰ï¼Œæ€§èƒ½å·® | âŒ |
| **Redis Stringè®¡æ•°** | ç®€å•å¿«é€Ÿ | éœ€è¦æ’åºï¼Œæ¯æ¬¡æŸ¥è¯¢éƒ½è¦è¯»æ•´ä¸ªæ•°æ®é›† | âŒ |
| **Redis Sorted Set** | è‡ªåŠ¨æ’åºï¼ŒèŒƒå›´æŸ¥è¯¢é«˜æ•ˆ | éœ€è¦å®šæ—¶åŒæ­¥åˆ°DB | âœ… |
| **Message Queue** | è§£è€¦å†™å…¥ | å®ç°å¤æ‚ï¼Œå»¶è¿Ÿé«˜ | âŒ |

#### Redis Sorted Setçš„ä¼˜åŠ¿

```
Sorted Set ç»“æ„:
{
  member: courseId (è¯¾ç¨‹ID)
  score: viewCount (è®¿é—®æ•°)
}

å…³é”®æ“ä½œ:
â€¢ ZINCRBY: O(log N) - åŸå­é€’å¢ï¼Œæ— é”ç«äº‰
â€¢ ZREVRANGE: O(log N + M) - å¿«é€Ÿè·å–å‰Nä¸ª
â€¢ ZRANK: O(log N) - æŸ¥è¯¢æ’å
â€¢ è‡ªåŠ¨æ’åº: æ— éœ€é¢å¤–è®¡ç®—
```

**ä¸ºä»€ä¹ˆæ˜¯æœ€ä¼˜é€‰æ‹©**ï¼š
1. åŸå­æ€§æ“ä½œ - æ— éœ€åŠ é”ï¼Œé«˜å¹¶å‘å®‰å…¨
2. è‡ªåŠ¨æ’åº - ZINCRBYæ—¶è‡ªåŠ¨ç»´æŠ¤æ’åºé¡ºåº
3. èŒƒå›´æŸ¥è¯¢ - ZREVRANGEç›´æ¥è·å–Top N
4. ä½å»¶è¿Ÿ - æ‰€æœ‰æ“ä½œéƒ½æ˜¯O(log N)çº§åˆ«

---

## ğŸ’¡ æ ¸å¿ƒé€»è¾‘è®¾è®¡

### 3. ä¸‰å±‚æ¶æ„

#### ç¬¬ä¸€å±‚ï¼šæ¥å£å±‚ï¼ˆControllerï¼‰
```
ç”¨æˆ·è¯·æ±‚
    â†“
CourseViewController (åŸºç¡€æ¥å£)
    â”œâ”€ record: è®°å½•è®¿é—®
    â”œâ”€ count: æŸ¥è¯¢è®¿é—®é‡
    â””â”€ top10: è·å–å‰10
    
CoursePopularityController (æ’è¡Œæ¥å£)
    â”œâ”€ ranking: è¯¦ç»†æ’è¡Œ+ç»Ÿè®¡
    â”œâ”€ top10-simple: ç®€åŒ–æ’è¡Œ
    â”œâ”€ getRanking: è¯¾ç¨‹æ’å
    â””â”€ isPopular: çƒ­é—¨æ£€æŸ¥

ä½œç”¨: å¤„ç†HTTPè¯·æ±‚ï¼Œå‚æ•°éªŒè¯ï¼Œé”™è¯¯å¤„ç†
```

#### ç¬¬äºŒå±‚ï¼šä¸šåŠ¡å±‚ï¼ˆServiceï¼‰
```
CourseViewService (æ¥å£)
    â†“
IMPL_CourseViewService (å®ç°)
    
æ ¸å¿ƒæ–¹æ³•:
â€¢ recordCourseView() - Redis ZINCRBY
â€¢ getPopularCourses() - Redis ZREVRANGE + DBæŸ¥è¯¢
â€¢ syncViewCountsToDatabase() - å®šæ—¶åŒæ­¥
â€¢ rebuildCourseViewCache() - ç¼“å­˜é‡å»º
â€¢ getCourseViewCount() - æŸ¥è¯¢è®¿é—®é‡

ä½œç”¨: ä¸šåŠ¡é€»è¾‘ï¼ŒRediså’ŒMySQLçš„åè°ƒ
```

#### ç¬¬ä¸‰å±‚ï¼šå­˜å‚¨å±‚ï¼ˆRedis + MySQLï¼‰
```
Redis (å†™å…¥å¿«é€Ÿ)
â”œâ”€ Sorted Set: popular:courses
â”‚  â””â”€ å­˜å‚¨: courseId -> viewCount
â””â”€ String: course:view:{id}
   â””â”€ å­˜å‚¨: å•ä¸ªè¯¾ç¨‹è®¿é—®æ•°

MySQL (æ•°æ®æŒä¹…åŒ–)
â””â”€ course_list.view_count
   â””â”€ å­˜å‚¨: æœ€ç»ˆç¡®è®¤çš„è®¿é—®æ•°
```

---

## ğŸ”„ æ•°æ®æµå‘è®¾è®¡

### 4. å…³é”®æ“ä½œæµç¨‹

#### æµç¨‹1ï¼šè®°å½•è®¿é—®ï¼ˆå†™å…¥ï¼‰
```
ç”¨æˆ·è®¿é—®è¯¾ç¨‹è¯¦æƒ…é¡µ
    â†“
POST /api/course/view/{courseId}/record
    â†“
IMPL_CourseViewService.recordCourseView()
    â”œâ”€ ZINCRBY popular:courses 1 courseId  [< 1ms]
    â”œâ”€ INCR course:view:{courseId}         [< 1ms]
    â””â”€ è¿”å›æˆåŠŸ
    
ä¼˜åŠ¿:
âœ“ ç«‹å³è¿”å›ï¼Œå“åº”æ—¶é—´ < 1ms
âœ“ åŸå­æ“ä½œï¼Œå¤šå¹¶å‘å®‰å…¨
âœ“ æ— æ•°æ®åº“æ“ä½œï¼Œä¸å½±å“ä¸»ä¸šåŠ¡
âœ“ è‡ªåŠ¨ç»´æŠ¤æ’åº
```

**ä¸ºä»€ä¹ˆåˆ†ä¸¤ä¸ªæ•°æ®ç»“æ„ï¼Ÿ**
- `Sorted Set`: ç”¨äºæ’åºå’ŒTop NæŸ¥è¯¢
- `String`: ç”¨äºå•ä¸ªè¯¾ç¨‹å¿«é€ŸæŸ¥è¯¢è®¿é—®é‡

#### æµç¨‹2ï¼šæŸ¥è¯¢æ’è¡Œï¼ˆè¯»å–ï¼‰
```
GET /api/course/popularity/ranking
    â†“
CoursePopularityController.getCoursePopularityRanking()
    â†“
IMPL_CourseViewService.getPopularCourses(10)
    â”‚
    â”œâ”€ã€ç¬¬1æ­¥ã€‘RedisæŸ¥è¯¢æ’åºæ•°æ®
    â”‚  ZREVRANGE popular:courses 0 9 WITHSCORES
    â”‚  â†’ è¿”å›: [(courseId, score), ...]  [< 1ms]
    â”‚
    â”œâ”€ã€ç¬¬2æ­¥ã€‘æ•°æ®åº“è¡¥å……å®Œæ•´ä¿¡æ¯
    â”‚  SELECT * FROM course_list WHERE id IN (courseId list)
    â”‚  â†’ è¿”å›: CourseListå¯¹è±¡                [< 10ms]
    â”‚
    â””â”€ã€ç¬¬3æ­¥ã€‘åˆå¹¶æ•°æ®
       æ„å»º CoursePopularityResponse
       åŒ…å«: items + stats
    
æ€»å“åº”æ—¶é—´: < 100ms

ä¸ºä»€ä¹ˆä¸å…¨ä»Redisè¯»?
âœ— Redisç¼ºå°‘è¯¾ç¨‹åç§°ã€æè¿°ç­‰è¯¦ç»†ä¿¡æ¯
âœ“ MySQLæœ‰å®Œæ•´çš„è¯¾ç¨‹æ•°æ®
âœ“ åˆ†ç¦»å…³æ³¨ç‚¹: Redisç®¡æ’åºï¼ŒMySQLç®¡æ•°æ®
```

#### æµç¨‹3ï¼šå®šæ—¶åŒæ­¥ï¼ˆæŒä¹…åŒ–ï¼‰
```
ã€ä»»åŠ¡1ã€‘æ¯30åˆ†é’Ÿæ‰§è¡Œ
syncViewCountsEveryHalfHour()
    â””â”€ ZRANGE popular:courses 0 -1
       â†’ è·å–æ‰€æœ‰è¯¾ç¨‹è®¿é—®æ•°
    â””â”€ UPDATE course_list SET view_count = ?
       â†’ æ‰¹é‡åŒæ­¥åˆ°MySQL
    
ã€ä»»åŠ¡2ã€‘æ¯å°æ—¶æ‰§è¡Œ
syncViewCountsHourly()
    â””â”€ åŒä»»åŠ¡1ï¼Œå®Œæ•´åŒæ­¥

ã€ä»»åŠ¡3ã€‘æ¯å¤©å‡Œæ™¨2ç‚¹æ‰§è¡Œ
rebuildCacheDailyAtMidnight()
    â”œâ”€ DEL popular:courses
    â”‚  â†’ æ¸…ç©ºRedis
    â”œâ”€ SELECT id, view_count FROM course_list
    â”‚  â†’ ä»MySQLè¯»å–æ•°æ®
    â””â”€ ZADD popular:courses ... [æ‰¹é‡]
       â†’ é‡å»ºRedisç¼“å­˜

è®¾è®¡ç›®çš„:
âœ“ å¼‚æ­¥åŒæ­¥ï¼Œä¸é˜»å¡ä¸»ä¸šåŠ¡
âœ“ æ‰¹é‡æ“ä½œï¼Œå‡å°‘IOæ¬¡æ•°
âœ“ å®šæœŸé‡å»ºï¼Œç¡®ä¿æ•°æ®ä¸€è‡´
âœ“ æ•…éšœæ¢å¤ï¼Œé˜²æ­¢Redisæ•°æ®ä¸¢å¤±
```

---

## ğŸ›¡ï¸ é«˜å¹¶å‘å¤„ç†è®¾è®¡

### 5. å¹¶å‘å®‰å…¨æ€§

#### é—®é¢˜åœºæ™¯
```
ç”¨æˆ·Aè®¿é—®è¯¾ç¨‹1 â†’ å†™å…¥Redis
ç”¨æˆ·Bè®¿é—®è¯¾ç¨‹1 â†’ å†™å…¥Redis
ç”¨æˆ·Cè®¿é—®è¯¾ç¨‹1 â†’ å†™å…¥Redis
...
1000ä¸ªå¹¶å‘è¯·æ±‚ â†’ å…¨éƒ¨å†™å…¥Redis
```

#### è§£å†³æ–¹æ¡ˆ
```
âœ“ Redis ZINCRBY æ˜¯åŸå­æ“ä½œ
  - MySQL ACIDäº‹åŠ¡æä¾›è¡Œçº§é”
  - Redis å•çº¿ç¨‹ç‰¹æ€§ä¿è¯åŸå­æ€§
  - æ— éœ€é¢å¤–åŠ é”

âœ“ è®¿é—®é‡é€’å¢çš„é¡ºåºæ— å…³ç´§è¦
  - åªå…³å¿ƒæœ€ç»ˆæ•°å€¼
  - æ— ç«æ€æ¡ä»¶

âœ“ å®šæœŸåŒæ­¥åˆ°MySQL
  - æ‰¹é‡æ“ä½œè€Œéé€æ¡
  - å‡å°‘MySQLé”ç«äº‰
```

#### æ€§èƒ½å¯¹æ¯”
```
æ–¹æ¡ˆ1: ç›´æ¥å†™MySQL
1000 req/s Ã— 10ms = 10s å»¶è¿Ÿï¼Œé”ç«äº‰ä¸¥é‡ âŒ

æ–¹æ¡ˆ2: Redis Sorted Set
1000 req/s Ã— 0.5ms = 0.5ms å»¶è¿Ÿï¼Œæ— é”ç«äº‰ âœ…

æ€§èƒ½æå‡: 20å€!
```

---

## ğŸ“Š æ•°æ®ä¸€è‡´æ€§è®¾è®¡

### 6. Redis ä¸ MySQL åŒæ­¥

#### é—®é¢˜
```
Redisä¸¢å¤±æ•°æ®ä¼šæ€æ ·?
â”œâ”€ å†…å­˜é‡å¯
â”œâ”€ æœåŠ¡å¼‚å¸¸
â””â”€ ç£ç›˜æ•…éšœ
```

#### è§£å†³ç­–ç•¥

**ç­–ç•¥1: å®šæ—¶åŒæ­¥**
```
Redis (å®æ—¶æ•°æ®)
    â†“ æ¯30åˆ†é’Ÿ
MySQL (ç¡®è®¤æ•°æ®)
    â†“ æ¯å¤©å‡Œæ™¨2ç‚¹
Redis (æ¢å¤æ•°æ®)

ä¼˜åŠ¿:
âœ“ æ•°æ®ä¸ä¼šå®Œå…¨ä¸¢å¤±
âœ“ åŒæ­¥å»¶è¿Ÿå¯æ§ï¼ˆ30åˆ†é’Ÿï¼‰
âœ“ MySQLä½œä¸ºæ•°æ®æº
```

**ç­–ç•¥2: ç®¡ç†æ¥å£**
```
POST /api/course/view/admin/sync
    â†’ ç«‹å³åŒæ­¥ä¸€æ¬¡

POST /api/course/view/admin/rebuild-cache
    â†’ ä»MySQLæ¢å¤æ‰€æœ‰æ•°æ®

ä½œç”¨:
âœ“ æ•…éšœæ—¶æ‰‹åŠ¨æ¢å¤
âœ“ ç¡®ä¿æ•°æ®æœ€ç»ˆä¸€è‡´
```

**ç­–ç•¥3: æ—¥å¿—è®°å½•**
```
æ¯æ¬¡åŒæ­¥æ“ä½œè®°å½•:
- å¼€å§‹æ—¶é—´
- åŒæ­¥æ•°é‡
- æˆåŠŸ/å¤±è´¥
- è€—æ—¶

ç”¨é€”:
âœ“ é—®é¢˜è¯Šæ–­
âœ“ æ€§èƒ½ç›‘æ§
âœ“ å®¡è®¡è¿½è¸ª
```

---

## ğŸ”§ å…³é”®è®¾è®¡ç»†èŠ‚

### 7. ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡

#### Q1: ä¸ºä»€ä¹ˆè¦æŸ¥è¯¢æ‰€æœ‰è¯¾ç¨‹å†æ’åºï¼Œè€Œä¸æ˜¯åªæŸ¥å‰10?
```
âŒ é”™è¯¯åšæ³•:
SELECT * FROM course_list 
ORDER BY view_count DESC 
LIMIT 10;

ä¸ºä»€ä¹ˆä¸è¡Œ:
â€¢ MySQLå…¨è¡¨æ’åºï¼ŒO(N log N)
â€¢ æ¯æ¬¡æŸ¥è¯¢éƒ½è¦è®¿é—®æ•°æ®åº“
â€¢ é«˜å¹¶å‘ä¸‹æ€§èƒ½å·®

âœ… æ­£ç¡®åšæ³•:
Redis ZREVRANGE popular:courses 0 9
    â†“ åªè·å–å‰10ä¸ªcourseId
    â†“ O(log N + 10) å¤æ‚åº¦
    â†“ æ„é€ INè¯­å¥
    â†“ SELECT * FROM course_list WHERE id IN (...)

ä¼˜åŠ¿:
â€¢ Rediså¿«é€Ÿæ’åº
â€¢ MySQLåªæŸ¥è¯¢10æ¡
â€¢ å……åˆ†åˆ©ç”¨ä¸¤ä¸ªæ•°æ®åº“çš„ä¼˜åŠ¿
```

#### Q2: ä¸ºä»€ä¹ˆåˆ†ç¦»è®¿é—®è®°å½•å’Œè¯¾ç¨‹è¯¦æƒ…?
```
âŒ ä¸€èµ·å­˜å‚¨:
{
  courseId: 1,
  viewCount: 1000,
  courseName: "JavaåŸºç¡€",
  courseIntroduction: "...",
  ...å…¶ä»–50ä¸ªå­—æ®µ
}

é—®é¢˜:
â€¢ è®¿é—®è®°å½•ç»å¸¸æ›´æ–°ï¼Œè¯¾ç¨‹è¯¦æƒ…å¾ˆå°‘å˜åŒ–
â€¢ æ•°æ®å†—ä½™ï¼Œæµªè´¹å†…å­˜
â€¢ Sorted Setä¸­å­˜å¤§å¯¹è±¡ä½æ•ˆ

âœ… åˆ†ç¦»å­˜å‚¨:
Redis:
  popular:courses: {1: 1000, 2: 950, ...}
  
MySQL:
  course_list: {id: 1, name: "JavaåŸºç¡€", ...}

ä¼˜åŠ¿:
â€¢ å„å¸å…¶èŒ
â€¢ å†…å­˜é«˜æ•ˆ
â€¢ æ›´æ–°çµæ´»
```

#### Q3: ä¸ºä»€ä¹ˆå®šæ—¶åŒæ­¥è€Œä¸æ˜¯å®æ—¶åŒæ­¥?
```
âŒ å®æ—¶åŒæ­¥:
ZINCRBY â†’ ç«‹å³ UPDATE MySQL
    â†“
1000å¹¶å‘ â†’ 1000ä¸ªUPDATE
    â†“
MySQLé”ç«äº‰ï¼Œæ€§èƒ½ä¸‹é™

âœ… å®šæ—¶åŒæ­¥:
1000 Ã— ZINCRBY â†’ ç§¯ç´¯30åˆ†é’Ÿ
    â†“
1æ¬¡ UPDATE (æ‰¹é‡)
    â†“
é«˜æ•ˆï¼Œä½å¼€é”€

æƒè¡¡:
â€¢ æ•°æ®å»¶è¿Ÿ: æœ€å¤š30åˆ†é’Ÿä¸åŒæ­¥
â€¢ æ€§èƒ½æå‡: 30å€å·¦å³
â€¢ å¯æ¥å—èŒƒå›´: è®¿é—®æ’è¡Œä¸éœ€è¦ç§’çº§å‡†ç¡®
```

---

## ğŸ¯ åŠŸèƒ½è®¾è®¡

### 8. APIæ¥å£è®¾è®¡æ€è·¯

#### åˆ†å±‚è®¾è®¡
```
CourseViewController (åŸºç¡€åŠŸèƒ½)
â”œâ”€ è®°å½•è®¿é—®
â”œâ”€ æŸ¥è¯¢è®¿é—®é‡
â””â”€ ç®€å•åˆ—è¡¨

CoursePopularityController (é«˜çº§åŠŸèƒ½)
â”œâ”€ è¯¦ç»†æ’è¡Œ(å«ç»Ÿè®¡)
â”œâ”€ æ’åæŸ¥è¯¢
â”œâ”€ çƒ­é—¨æ£€æŸ¥
â””â”€ èŒƒå›´æŸ¥è¯¢

åˆ†ç¦»åŸå› :
âœ“ å…³æ³¨ç‚¹åˆ†ç¦»
âœ“ æ˜“äºç»´æŠ¤
âœ“ æ¥å£æ¸…æ™°
```

#### ç®¡ç†æ¥å£è®¾è®¡
```
æ‰‹åŠ¨åŒæ­¥: POST /api/course/view/admin/sync
    â””â”€ ç”¨é€”: æ•°æ®ä¸ä¸€è‡´æ—¶æ‰‹åŠ¨ä¿®å¤

é‡å»ºç¼“å­˜: POST /api/course/view/admin/rebuild-cache
    â””â”€ ç”¨é€”: Redisæ•°æ®ä¸¢å¤±æ—¶æ¢å¤

æ¸…é™¤è®°å½•: DELETE /api/course/view/admin/clear/{id}
    â””â”€ ç”¨é€”: å¼‚å¸¸æ•°æ®æ¸…ç†

è®¾è®¡åŸåˆ™:
âœ“ æä¾›ç®¡ç†å‘˜å¯è§æ€§
âœ“ æ•…éšœæ¢å¤èƒ½åŠ›
âœ“ æ•°æ®ç»´æŠ¤çµæ´»æ€§
```

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–æ€è·¯

### 9. æ€§èƒ½æŒ‡æ ‡ç›®æ ‡

| æŒ‡æ ‡ | ç›®æ ‡ | å®ç°æ–¹å¼ |
|------|------|--------|
| è®¿é—®è®°å½•å»¶è¿Ÿ | < 1ms | Redis ZINCRBY |
| æ’è¡ŒæŸ¥è¯¢å»¶è¿Ÿ | < 100ms | RedisæŸ¥è¯¢ + æ•°æ®åº“æŸ¥è¯¢ |
| å¹¶å‘èƒ½åŠ› | 10,000+ req/s | æ— é”è®¾è®¡ï¼ŒRedisæ€§èƒ½ |
| æ•°æ®å»¶è¿Ÿ | 30åˆ†é’Ÿ | å®šæ—¶åŒæ­¥ |

### 10. ä¼˜åŒ–ç­–ç•¥

#### ç­–ç•¥1: ç¼“å­˜åˆ†å±‚
```
L1ç¼“å­˜ (Redis Sorted Set)
    â†“ ç”¨äºæ’åºå’ŒTop NæŸ¥è¯¢
    â†“ å“åº”æ—¶é—´: < 1ms
    
L2ç¼“å­˜ (MySQLè¡¨)
    â†“ ç”¨äºå†å²æ•°æ®å’Œè¯¦ç»†ä¿¡æ¯
    â†“ å“åº”æ—¶é—´: < 10ms
    
L3ç¼“å­˜ (åº”ç”¨å±‚)
    â†“ çƒ­æ•°æ®åº”ç”¨å±‚ç¼“å­˜
    â†“ å“åº”æ—¶é—´: å†…å­˜çº§åˆ«
```

#### ç­–ç•¥2: æ‰¹é‡æ“ä½œ
```
åŒæ­¥æ“ä½œ:
âœ— é€æ¡: 1000æ¡ Ã— 5ms = 5000ms
âœ“ æ‰¹é‡: 1æ¬¡ Ã— 100ms = 100ms

æå‡: 50å€!
```

#### ç­–ç•¥3: å¼‚æ­¥å¤„ç†
```
åŒæ­¥ä»»åŠ¡åå°è¿è¡Œ
    â”œâ”€ ä¸é˜»å¡ä¸»ä¸šåŠ¡
    â”œâ”€ å®šæ—¶è‡ªåŠ¨æ‰§è¡Œ
    â””â”€ æ”¯æŒæ‰‹åŠ¨è§¦å‘

å¥½å¤„:
âœ“ ä¸»çº¿ç¨‹ä¸ç­‰å¾…
âœ“ ç”¨æˆ·æ— æ„ŸçŸ¥
âœ“ ç³»ç»Ÿæ›´ç¨³å®š
```

---

## ğŸ” é”™è¯¯å¤„ç†è®¾è®¡

### 11. å®¹é”™æœºåˆ¶

#### è®¾è®¡åŸåˆ™
```
âœ“ è®¿é—®è®°å½•å¤±è´¥ â†’ è®°å½•æ—¥å¿—ï¼Œä¸å½±å“ç”¨æˆ·
âœ“ æŸ¥è¯¢å¤±è´¥ â†’ è¿”å›ç©ºåˆ—è¡¨æˆ–ç¼“å­˜æ•°æ®
âœ“ åŒæ­¥å¤±è´¥ â†’ è‡ªåŠ¨é‡è¯•ï¼Œè®°å½•å‘Šè­¦
âœ“ ç¼“å­˜ä¸¢å¤± â†’ è‡ªåŠ¨é‡å»ºï¼Œæ— éœ€å¹²é¢„
```

#### å…·ä½“å®ç°
```java
try {
    // ä¸šåŠ¡ä»£ç 
    ZINCRBY ...
} catch (Exception e) {
    log.error("è®°å½•è®¿é—®å¤±è´¥", e);
    // ä¸æŠ›å¼‚å¸¸ï¼Œç»§ç»­å¤„ç†
}

// åŒæ­¥å¤±è´¥å¤„ç†
for (CourseList course : allCourses) {
    try {
        // æ›´æ–°
    } catch (Exception e) {
        // è®°å½•å¤±è´¥ï¼Œç»§ç»­å¤„ç†ä¸‹ä¸€ä¸ª
        log.warn("åŒæ­¥å¤±è´¥: {}", course.getId(), e);
        failCount++;
    }
}
log.info("åŒæ­¥å®Œæˆ: æ€»æ•°={}, æˆåŠŸ={}, å¤±è´¥={}", ...);
```

---

## ğŸ“ æ€»ç»“ï¼šæ ¸å¿ƒè®¾è®¡å†³ç­–

### 12. ä¸ºä»€ä¹ˆè¿™æ ·åš

| å†³ç­– | ç†ç”± | æƒè¡¡ |
|------|------|------|
| ä½¿ç”¨Redis Sorted Set | å¤©ç„¶æ’åºï¼Œé«˜æ€§èƒ½ | éœ€è¦å®šæ—¶åŒæ­¥ |
| å®šæ—¶åŒæ­¥åˆ°MySQL | æ•°æ®æŒä¹…åŒ– | æ•°æ®å»¶è¿Ÿ30åˆ†é’Ÿ |
| åˆ†ç¦»è¯»å†™æ“ä½œ | æ€§èƒ½æœ€ä¼˜ | å®ç°å¤æ‚åº¦å¢åŠ  |
| æä¾›ç®¡ç†æ¥å£ | æ•…éšœæ¢å¤ | å¢åŠ å®‰å…¨éšæ‚£ |
| å¼‚æ­¥å®šæ—¶ä»»åŠ¡ | ä¸é˜»å¡ä¸»ä¸šåŠ¡ | éœ€è¦è°ƒåº¦æ¡†æ¶ |
| è¯¦ç»†æ—¥å¿—è®°å½• | é—®é¢˜è¯Šæ–­ | ç£ç›˜ç©ºé—´å ç”¨ |

---

## ğŸš€ æ‰©å±•æ–¹å‘

### 13. å¯èƒ½çš„ä¼˜åŒ–

**çŸ­æœŸ**
- æ·»åŠ æƒé™æ§åˆ¶
- ç›‘æ§å‘Šè­¦
- æ€§èƒ½æŒ‡æ ‡é‡‡é›†

**ä¸­æœŸ**
- Redisé›†ç¾¤éƒ¨ç½²
- MySQLä¸»ä»å¤åˆ¶
- å¤šç»´åº¦æ’è¡Œï¼ˆå‘¨æ’è¡Œã€æœˆæ’è¡Œï¼‰

**é•¿æœŸ**
- æ¨èç³»ç»Ÿé›†æˆ
- æ•°æ®åˆ†ææŠ¥è¡¨
- æœºå™¨å­¦ä¹ é¢„æµ‹

---

è¿™å°±æ˜¯æ•´ä¸ªçƒ­é—¨è¯¾ç¨‹æ’è¡ŒåŠŸèƒ½çš„å®Œæ•´è®¾è®¡æ€è·¯ï¼

